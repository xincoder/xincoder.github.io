<!DOCTYPE html><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.4.0 for Hugo" />
  

  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media="print" onload="this.media='all'">
    
  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Xin Li" />

  
  
  
    
  
  <meta name="description" content="Train a CNN model to recognize traffic signs." />

  
  <link rel="alternate" hreflang="en-us" href="http://xincoder.github.io/project/selfdriving_signclassification/" />

  
  
  
    <meta name="theme-color" content="#1565c0" />
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.f1ecf783c14edc00c9320c205831ad8e.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha512-W0xM4mr6dEP9nREo7Z9z+9X70wytKvMGeDsj7ps2+xg5QPrEBXC8tAW1IFnzjR6eoJ90JmCnFzerQJTLzIEHjA==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/github.min.css" crossorigin="anonymous" title="hl-light" media="print" onload="this.media='all'">
          <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" media="print" onload="this.media='all'" disabled>
        
      
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.d3fbabf3e02f0a40f84592dd992c35ca.css" />

  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-128386120-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-128386120-1', {});
  gtag('set', {'cookie_flags': 'SameSite=None;Secure'});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  


  




  
  
  

  

  
    <link rel="manifest" href="/manifest.webmanifest" />
  

  <link rel="icon" type="image/png" href="/media/icon_hufdd866d90d76849587aac6fbf27da1ac_464_32x32_fill_lanczos_center_3.png" />
  <link rel="apple-touch-icon" type="image/png" href="/media/icon_hufdd866d90d76849587aac6fbf27da1ac_464_180x180_fill_lanczos_center_3.png" />

  <link rel="canonical" href="http://xincoder.github.io/project/selfdriving_signclassification/" />

  
  
  
  
  
  
  
  
    
  
  

  
  
    
    
  
  <meta property="twitter:card" content="summary_large_image" />
  
  <meta property="og:site_name" content="Welcome to Xin&#39;s Homepage" />
  <meta property="og:url" content="http://xincoder.github.io/project/selfdriving_signclassification/" />
  <meta property="og:title" content="Traffic Sign Recognition [Self Driving] | Welcome to Xin&#39;s Homepage" />
  <meta property="og:description" content="Train a CNN model to recognize traffic signs." /><meta property="og:image" content="http://xincoder.github.io/project/selfdriving_signclassification/featured.png" />
    <meta property="twitter:image" content="http://xincoder.github.io/project/selfdriving_signclassification/featured.png" /><meta property="og:locale" content="en-us" />
  
    
      <meta
        property="article:published_time"
        content="2018-07-16T00:00:00&#43;00:00"
      />
    
    <meta property="article:modified_time" content="2018-07-16T00:00:00&#43;00:00">
  

  


    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "http://xincoder.github.io/project/selfdriving_signclassification/"
  },
  "headline": "Traffic Sign Recognition [Self Driving]",
  
  "image": [
    "http://xincoder.github.io/project/selfdriving_signclassification/featured.png"
  ],
  
  "datePublished": "2018-07-16T00:00:00Z",
  "dateModified": "2018-07-16T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Xin Li"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Welcome to Xin's Homepage",
    "logo": {
      "@type": "ImageObject",
      "url": "http://xincoder.github.io/media/icon_hufdd866d90d76849587aac6fbf27da1ac_464_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "Train a CNN model to recognize traffic signs."
}
</script>

  

  

  

  





  <title>Traffic Sign Recognition [Self Driving] | Welcome to Xin&#39;s Homepage</title>
</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="8899ad43543fa956e424fc2c816de8ac" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.d5094052a6270c81ab9495f4173f87a9.js"></script>

  


<aside class="search-modal" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#" aria-label="Close"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search" class="form-control"
        aria-label="Search...">
        
      </div>

      
      

      

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>



  <div class="page-header">
    












<header class="header--fixed">
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Welcome to Xin&#39;s Homepage</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Welcome to Xin&#39;s Homepage</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#awards"><span>Awards</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#publications"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#intern"><span>Internship</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#teaching"><span>Teaching</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Projects</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
          

          <li class="nav-item">
            <a class="nav-link " href="/blogs/"><span>Blogs</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        

        
        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article article-project">

  





















  
  


<div class="article-container pt-3">
  <h1>Traffic Sign Recognition [Self Driving]</h1>

  

  


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Jul 16, 2018
  </span>
  

  

  

  
  
  
  

  
  

</div>

  





</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 712px;">
  <div style="position: relative">
    <img src="/project/selfdriving_signclassification/featured_hua3ea79a7ed0037084cb57388786915d9_42768_720x2500_fit_q75_h2_lanczos_3.webp" width="720" height="712" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      <h1 id="traffic-sign-recognition"><strong>Traffic Sign Recognition</strong></h1>
<p>Programming Language:</p>
<ul>
<li>Python</li>
</ul>
<p>The goals of this project are the following:</p>
<ul>
<li>Load the data set (see below for links to the project data set)</li>
<li>Explore, summarize and visualize the data set</li>
<li>Design, train and test a model architecture</li>
<li>Use the model to make predictions on new images</li>
<li>Analyze the softmax probabilities of the new images</li>
<li>Summarize the results with a written report</li>
</ul>
<hr>
<h2 id="step1-data-set-summary--exploration">Step1: Data Set Summary &amp; Exploration</h2>
<h4 id="1-a-basic-summary-of-the-data-set">1. A basic summary of the data set.</h4>
<p>I use Pickle data load function to read our dataset, and then use basic python function to analyze the dataset. In total, we have:</p>
<ul>
<li>Training samples: 34,799</li>
<li>Validation samples: 4,410</li>
<li>Testing samples: 12,630</li>
<li>Each sample (image) has (32, 32, 3) shape.</li>
<li>We have 43 unique classes/labels:</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">ClassId</td>
<td style="text-align:center">SignName</td>
<td style="text-align:center">ClassId</td>
<td style="text-align:center">SignName</td>
<td style="text-align:center">ClassId</td>
<td style="text-align:center">SignName</td>
</tr>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">Speed limit (20km/h)</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Speed limit (30km/h)</td>
<td style="text-align:center">2</td>
<td style="text-align:center">Speed limit (50km/h)</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Speed limit (60km/h)</td>
<td style="text-align:center">4</td>
<td style="text-align:center">Speed limit (70km/h)</td>
<td style="text-align:center">5</td>
<td style="text-align:center">Speed limit (80km/h)</td>
</tr>
<tr>
<td style="text-align:center">6</td>
<td style="text-align:center">End of speed limit (80km/h)</td>
<td style="text-align:center">7</td>
<td style="text-align:center">Speed limit (100km/h)</td>
<td style="text-align:center">8</td>
<td style="text-align:center">Speed limit (120km/h)</td>
</tr>
<tr>
<td style="text-align:center">9</td>
<td style="text-align:center">No passing</td>
<td style="text-align:center">10</td>
<td style="text-align:center">No passing for vehicles over 3.5 metric tons</td>
<td style="text-align:center">11</td>
<td style="text-align:center">Right-of-way at the next intersection</td>
</tr>
<tr>
<td style="text-align:center">12</td>
<td style="text-align:center">Priority road</td>
<td style="text-align:center">13</td>
<td style="text-align:center">Yield</td>
<td style="text-align:center">14</td>
<td style="text-align:center">Stop</td>
</tr>
<tr>
<td style="text-align:center">15</td>
<td style="text-align:center">No vehicles</td>
<td style="text-align:center">16</td>
<td style="text-align:center">Vehicles over 3.5 metric tons prohibited</td>
<td style="text-align:center">17</td>
<td style="text-align:center">No entry</td>
</tr>
<tr>
<td style="text-align:center">18</td>
<td style="text-align:center">General caution</td>
<td style="text-align:center">19</td>
<td style="text-align:center">Dangerous curve to the left</td>
<td style="text-align:center">20</td>
<td style="text-align:center">Dangerous curve to the right</td>
</tr>
<tr>
<td style="text-align:center">21</td>
<td style="text-align:center">Double curve</td>
<td style="text-align:center">22</td>
<td style="text-align:center">Bumpy road</td>
<td style="text-align:center">23</td>
<td style="text-align:center">Slippery road</td>
</tr>
<tr>
<td style="text-align:center">24</td>
<td style="text-align:center">Road narrows on the right</td>
<td style="text-align:center">25</td>
<td style="text-align:center">Road work</td>
<td style="text-align:center">26</td>
<td style="text-align:center">Traffic signals</td>
</tr>
<tr>
<td style="text-align:center">27</td>
<td style="text-align:center">Pedestrians</td>
<td style="text-align:center">28</td>
<td style="text-align:center">Children crossing</td>
<td style="text-align:center">29</td>
<td style="text-align:center">Bicycles crossing</td>
</tr>
<tr>
<td style="text-align:center">30</td>
<td style="text-align:center">Beware of ice/snow</td>
<td style="text-align:center">31</td>
<td style="text-align:center">Wild animals crossing</td>
<td style="text-align:center">32</td>
<td style="text-align:center">End of all speed and passing limits</td>
</tr>
<tr>
<td style="text-align:center">33</td>
<td style="text-align:center">Turn right ahead</td>
<td style="text-align:center">34</td>
<td style="text-align:center">Turn left ahead</td>
<td style="text-align:center">35</td>
<td style="text-align:center">Ahead only</td>
</tr>
<tr>
<td style="text-align:center">36</td>
<td style="text-align:center">Go straight or right</td>
<td style="text-align:center">37</td>
<td style="text-align:center">Go straight or left</td>
<td style="text-align:center">38</td>
<td style="text-align:center">Keep right</td>
</tr>
<tr>
<td style="text-align:center">39</td>
<td style="text-align:center">Keep left</td>
<td style="text-align:center">40</td>
<td style="text-align:center">Roundabout mandatory</td>
<td style="text-align:center">41</td>
<td style="text-align:center">End of no passing</td>
</tr>
<tr>
<td style="text-align:center">42</td>
<td style="text-align:center">End of no passing by vehicles over 3.5 metric tons</td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="class_samples.png" srcset="
               /project/selfdriving_signclassification/class_samples_huaeab329b455c9b7b8771b6f0046720b7_199239_27fbaf4a83f9a0f6db9b4b2cd7455b14.webp 400w,
               /project/selfdriving_signclassification/class_samples_huaeab329b455c9b7b8771b6f0046720b7_199239_808420021f2ac3d70d632893fd03fae4.webp 760w,
               /project/selfdriving_signclassification/class_samples_huaeab329b455c9b7b8771b6f0046720b7_199239_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/project/selfdriving_signclassification/class_samples_huaeab329b455c9b7b8771b6f0046720b7_199239_27fbaf4a83f9a0f6db9b4b2cd7455b14.webp"
               width="760"
               height="569"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h4 id="2-here-is-an-exploratory-visualization-of-the-data-set">2. Here is an exploratory visualization of the data set.</h4>
<p>















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="data_bar.png" srcset="
               /project/selfdriving_signclassification/data_bar_hu0f5ca4597522f72be28732ee917c34a8_14178_fd2da047a815bcf5312296379f196a8d.webp 400w,
               /project/selfdriving_signclassification/data_bar_hu0f5ca4597522f72be28732ee917c34a8_14178_c2a87ac5b95061ab139037a89aba4f5b.webp 760w,
               /project/selfdriving_signclassification/data_bar_hu0f5ca4597522f72be28732ee917c34a8_14178_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/project/selfdriving_signclassification/data_bar_hu0f5ca4597522f72be28732ee917c34a8_14178_fd2da047a815bcf5312296379f196a8d.webp"
               width="760"
               height="210"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<hr>
<h3 id="step2-design-and-test-a-model-architecture">Step2: Design and Test a Model Architecture</h3>
<h4 id="1-image-data-preprocessing">1. Image data preprocessing</h4>
<p>I use two methods to do data augmentation (preprocessing).</p>
<ol>
<li>Randomly rotation: all training images have 50% probability to be rotated within (-30, 30) angle. Rotation is needed considering that in daily life, the camera on a self-driving car may capture a traffice sign with a radom angle. Thus, by doing this help the model has the capability of handling such an application scenario.</li>
<li>Randomly crop: all training images have 50% probability to be cropped from (0.8, 1) of width and height. After being cropped, the images will be resized back to 32x32. Cropping is necessary because the captured traffic signs have variant sizes. Thus, using cropping adds more training data. In addition, randomly cropping provides some smaples with width and height shifts.</li>
</ol>
<p>Here are some processed images:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="augmentation.png" srcset="
               /project/selfdriving_signclassification/augmentation_hud2883a39eb3f88d7d2614760cad77eba_77230_1efd78925926b67073d5ccff0a6dbc84.webp 400w,
               /project/selfdriving_signclassification/augmentation_hud2883a39eb3f88d7d2614760cad77eba_77230_21257824055c89dc97397fe1b6ef8fd2.webp 760w,
               /project/selfdriving_signclassification/augmentation_hud2883a39eb3f88d7d2614760cad77eba_77230_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/project/selfdriving_signclassification/augmentation_hud2883a39eb3f88d7d2614760cad77eba_77230_1efd78925926b67073d5ccff0a6dbc84.webp"
               width="760"
               height="157"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h4 id="2-model-architecture">2. Model architecture</h4>
<p>My model consisted of the following layers:</p>
<table>
<thead>
<tr>
<th style="text-align:center">Layer</th>
<th style="text-align:center">Input_Size</th>
<th style="text-align:center">Output_size</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">Convolution(5x5)</td>
<td style="text-align:center">32x32x3</td>
<td style="text-align:center">28x28x64</td>
<td style="text-align:center">(1x1) stride, VALID padding, Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Convolution(3x3)</td>
<td style="text-align:center">28x28x64</td>
<td style="text-align:center">28x28x64</td>
<td style="text-align:center">(1x1) stride, SAME padding, Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Pooling</td>
<td style="text-align:center">28x28x64</td>
<td style="text-align:center">14x14x6</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">Convolution(5x5)</td>
<td style="text-align:center">14x14x64</td>
<td style="text-align:center">10x10x128</td>
<td style="text-align:center">(1x1) stride, VALID padding, Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Convolution(3x3)</td>
<td style="text-align:center">10x10x128</td>
<td style="text-align:center">10x10x128</td>
<td style="text-align:center">(1x1) stride, SAME padding, Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Pooling</td>
<td style="text-align:center">10x10x128</td>
<td style="text-align:center">5x5x12</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">Convolution(3x3)</td>
<td style="text-align:center">5x5x128</td>
<td style="text-align:center">3x3x256</td>
<td style="text-align:center">(1x1) stride, VALID padding, Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Pooling</td>
<td style="text-align:center">3x3x256</td>
<td style="text-align:center">1x1x25</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">Flatten</td>
<td style="text-align:center">1x1x256</td>
<td style="text-align:center">256</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">Fully Connected</td>
<td style="text-align:center">256</td>
<td style="text-align:center">128</td>
<td style="text-align:center">Relu Activation</td>
</tr>
<tr>
<td style="text-align:center">Dropout layer</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">Fully Connected</td>
<td style="text-align:center">128</td>
<td style="text-align:center">43</td>
<td style="text-align:center">Softmax Activation</td>
</tr>
</tbody>
</table>
<h4 id="3-training-parameters">3. Training parameters</h4>
<p>I use the following experimental settings to train my model:</p>
<ul>
<li>Optimizer: Adam</li>
<li>Initialial Learning Rate: 0.001</li>
<li>Batch Size: 128</li>
<li>Training Epochs: 100</li>
<li>Loss function: cross entropy.</li>
</ul>
<h4 id="4-accuracy">4. Accuracy</h4>
<p>During training, I tracked the validation accuracy and only saved the weights achieved the highest validation accuracy. Within 100 training epochs, my architecture achieves the highest val_acc at 84 epoch. (All details about training process can be found in Cell [10])</p>
<ul>
<li><span style="color:orange">The accuracy on training set: <strong>99.9%</strong></span></li>
<li><span style="color:orange">The accuracy on validation set: <strong>96.2%</strong></span></li>
<li><span style="color:orange">The accuracy on testing set: <strong>93.4%</strong></span></li>
</ul>
<p>The followings are the reasons why I chose such a model for this task:</p>
<ol>
<li>In the first convolutional laeyrs, the model focuses on detecting fundamental features, e.g. lines, shapes, or textures. Thus, at the first two blocks (4 convolutional layers), I used two continuous convolutional layers to make sure that the model generates more useful basic features.</li>
<li>Following that, a block with one convolutional layer is used to generate semantic information, e.g. arrows, circles, and etc.. Comparing to the basic features, we have more semantic features, thus, more filters were used in this layer.</li>
<li>A fully connected layer is used to convert a feature map into a verctor for classification.</li>
<li>One Dropout layer is used to avoid overfitting.</li>
</ol>
<h3 id="test-a-model-on-new-images">Test a Model on New Images</h3>
<h4 id="1-unseen-data-during-traing">1. Unseen data during traing</h4>
<p>Here are five German traffic signs that I found on the web:
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="online.png" srcset="
               /project/selfdriving_signclassification/online_hu6fbc8df78130d383a97b3112505cbaf4_42331_f1cb3965d8d23cfc9c158c93ff085305.webp 400w,
               /project/selfdriving_signclassification/online_hu6fbc8df78130d383a97b3112505cbaf4_42331_b8d3ed3169cac4aae0de205079208ef6.webp 760w,
               /project/selfdriving_signclassification/online_hu6fbc8df78130d383a97b3112505cbaf4_42331_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/project/selfdriving_signclassification/online_hu6fbc8df78130d383a97b3112505cbaf4_42331_f1cb3965d8d23cfc9c158c93ff085305.webp"
               width="378"
               height="93"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>
<h4 id="2-prediction-results-on-these-new-traffic-signs">2. Prediction results on these new traffic signs.</h4>
<p>Here are the results of the prediction:</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Image Ground Truth</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
<td style="text-align:center"><strong>Predicted Correctly</strong></td>
</tr>
<tr>
<td style="text-align:center">Go straight or right</td>
<td style="text-align:center">Go straight or right</td>
<td style="text-align:center">True</td>
</tr>
<tr>
<td style="text-align:center">Speed limit (50km/h)</td>
<td style="text-align:center">Speed limit (50km/h)</td>
<td style="text-align:center">True</td>
</tr>
<tr>
<td style="text-align:center">Stop</td>
<td style="text-align:center">Yield</td>
<td style="text-align:center">False</td>
</tr>
<tr>
<td style="text-align:center">Road work</td>
<td style="text-align:center">Road work</td>
<td style="text-align:center">True</td>
</tr>
<tr>
<td style="text-align:center">Turn right ahead</td>
<td style="text-align:center">Turn right ahead</td>
<td style="text-align:center">True</td>
</tr>
</tbody>
</table>
<p>The model was able to correctly guess 4 of the 5 traffic signs, which gives an accuracy of 80%. We can see it drops a lot comparing to the accuracy on our testing dataset. The reason is three-fold:</p>
<ol>
<li>The training dataset is not balance. For example, class 2 (Speed limit (50km/h)) has 2010 training samples, while class 14 (Stop) only consistes of 330 training samples.</li>
<li>The downloaded images are much clearer than the images in our dataset, which may add more noise in the images.</li>
<li>5 images are not enough to evaluate the performance of a trained model.</li>
</ol>
<h4 id="3-prediction-details">3. Prediction details</h4>
<p>For the first image, the model is 100% sure that it is a &ldquo;Go straight or right&rdquo;. It is correctly predict this image.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Probability</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
</tr>
<tr>
<td style="text-align:center">1.0000000</td>
<td style="text-align:center">36 (Go straight or right)</td>
</tr>
<tr>
<td style="text-align:center">2.8858561e-16</td>
<td style="text-align:center">3 (Speed limit (60km/h))</td>
</tr>
<tr>
<td style="text-align:center">2.1692284e-31</td>
<td style="text-align:center">0 (Speed limit (20km/h))</td>
</tr>
<tr>
<td style="text-align:center">7.6920753e-32</td>
<td style="text-align:center">20 (Dangerous curve to the right)</td>
</tr>
<tr>
<td style="text-align:center">2.2140123e-32</td>
<td style="text-align:center">28 (Children crossing)</td>
</tr>
</tbody>
</table>
<p>For the second image, the model is 100% sure that it is a &ldquo;Speed limit (50km/h)&rdquo;. It is correctly predict this image.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Probability</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
</tr>
<tr>
<td style="text-align:center">9.9999976e-01</td>
<td style="text-align:center">2 (Speed limit (50km/h))</td>
</tr>
<tr>
<td style="text-align:center">2.8747601e-07</td>
<td style="text-align:center">5 (Speed limit (80km/h))</td>
</tr>
<tr>
<td style="text-align:center">2.2901984e-10</td>
<td style="text-align:center">1 (Speed limit (30km/h))</td>
</tr>
<tr>
<td style="text-align:center">2.2646303e-18</td>
<td style="text-align:center">3 (Speed limit (60km/h))</td>
</tr>
<tr>
<td style="text-align:center">4.5397839e-35</td>
<td style="text-align:center">6 (End of speed limit (80km/h))</td>
</tr>
</tbody>
</table>
<p>For the third image, the model is 100% sure that it is a &ldquo;Yield&rdquo;, while the ground truth is &ldquo;Stop&rdquo;. There are only 690 &ldquo;Stop&rdquo; training samples in our dataset, while &ldquo;Yield&rdquo; has 1290 training images. This is caused by our un-balance training data.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Probability</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
</tr>
<tr>
<td style="text-align:center">1.0000000e+00</td>
<td style="text-align:center">13 (Yield)</td>
</tr>
<tr>
<td style="text-align:center">4.3748559e-12</td>
<td style="text-align:center">28 (Children crossing)</td>
</tr>
<tr>
<td style="text-align:center">1.5492816e-12</td>
<td style="text-align:center">1 (Speed limit (30km/h))</td>
</tr>
<tr>
<td style="text-align:center">1.0894177e-12</td>
<td style="text-align:center">38 (Keep right)</td>
</tr>
<tr>
<td style="text-align:center">6.2159755e-13</td>
<td style="text-align:center">2 (Speed limit (50km/h))</td>
</tr>
</tbody>
</table>
<p>For the fourth image, the model is 100% sure that it is a &ldquo;Road work&rdquo;. It is correctly predict this image.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Probability</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
</tr>
<tr>
<td style="text-align:center">1.0000000e+00</td>
<td style="text-align:center">25</td>
</tr>
<tr>
<td style="text-align:center">0.0000000e+00</td>
<td style="text-align:center">0 (Speed limit (20km/h))</td>
</tr>
<tr>
<td style="text-align:center">0.0000000e+00</td>
<td style="text-align:center">1 (Speed limit (30km/h))</td>
</tr>
<tr>
<td style="text-align:center">0.0000000e+00</td>
<td style="text-align:center">2 (Speed limit (50km/h))</td>
</tr>
<tr>
<td style="text-align:center">0.0000000e+00</td>
<td style="text-align:center">3 (Speed limit (60km/h))</td>
</tr>
</tbody>
</table>
<p>For the fourth image, the model is 100% sure that it is a &ldquo;Turn right ahead&rdquo;. It is correctly predict this image.</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center"></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><strong>Probability</strong></td>
<td style="text-align:center"><strong>Prediction</strong></td>
</tr>
<tr>
<td style="text-align:center">9.9085110e-01</td>
<td style="text-align:center">33 (Turn right ahead)</td>
</tr>
<tr>
<td style="text-align:center">8.0864038e-03</td>
<td style="text-align:center">14 (Stop)</td>
</tr>
<tr>
<td style="text-align:center">1.0624588e-03</td>
<td style="text-align:center">4 (Speed limit (70km/h))</td>
</tr>
<tr>
<td style="text-align:center">2.1159234e-11</td>
<td style="text-align:center">13 (Yield)</td>
</tr>
<tr>
<td style="text-align:center">7.8768702e-12</td>
<td style="text-align:center">2 (Speed limit (50km/h))</td>
</tr>
</tbody>
</table>
<h3 id="visualizing-the-model">Visualizing the model</h3>
<p>I visulized the output of the first block. The circle and arrows are very clear.
















<figure  >
  <div class="d-flex justify-content-center">
    <div class="w-100" ><img alt="vis.png" srcset="
               /project/selfdriving_signclassification/vis_hua3ea79a7ed0037084cb57388786915d9_42768_505e78c24db2173b826452c6f6531006.webp 400w,
               /project/selfdriving_signclassification/vis_hua3ea79a7ed0037084cb57388786915d9_42768_0baf066a6b144560a9f684552fdea062.webp 760w,
               /project/selfdriving_signclassification/vis_hua3ea79a7ed0037084cb57388786915d9_42768_1200x1200_fit_q75_h2_lanczos_3.webp 1200w"
               src="/project/selfdriving_signclassification/vis_hua3ea79a7ed0037084cb57388786915d9_42768_505e78c24db2173b826452c6f6531006.webp"
               width="760"
               height="751"
               loading="lazy" data-zoomable /></div>
  </div></figure>
</p>

    </div>

    




<div class="article-tags">
  
  <a class="badge badge-light" href="/tag/self-driving/">Self Driving</a>
  
  <a class="badge badge-light" href="/tag/python/">Python</a>
  
</div>













  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="http://xincoder.github.io"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu048704439fd518801f0e7415381cf149_109488_270x270_fill_q75_lanczos_center.jpg" alt="Xin Li"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="http://xincoder.github.io">Xin Li</a></h5>
      <h6 class="card-subtitle">Senior Machine Learning Engineer</h6>
      <p class="card-text">My research interests include Deep Learning, Computer Vision, and Autonomous Driving.</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/xin-li-a085254a" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  



  

  

  

  
  






  




  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

      

    
    <script src="/js/vendor-bundle.min.3d946de2e8784a477845261d87025092.js"></script>

    
    
    
      
      
        <script src="https://cdn.jsdelivr.net/gh/desandro/imagesloaded@v4.1.4/imagesloaded.pkgd.min.js" integrity="sha512-S5PZ9GxJZO16tT9r3WJp/Safn31eu8uWrzglMahDT4dsmgqWonRY9grk3j+3tfuPr9WJNsfooOR7Gi7HL5W2jw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/metafizzy/isotope@v3.0.6/dist/isotope.pkgd.min.js" integrity="sha512-Zq2BOxyhvnRFXu0+WE6ojpZLOU2jdnqbrM1hmVdGzyeCa1DgM3X5Q4A/Is9xA1IkbUeDd7755dNNI/PzSf2Pew==" crossorigin="anonymous"></script>
      

      
      

      

      
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/highlight.min.js" integrity="sha512-Ypjm0o7jOxAd4hpdoppSEN0TQOC19UtPAqD+4s5AlXmUvbmmS/YMxYqAqarQYyxTnB6/rqip9qcxlNB/3U9Wdg==" crossorigin="anonymous"></script>
        
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/r.min.js" crossorigin="anonymous"></script>
        
        <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.1/build/languages/latex.min.js" crossorigin="anonymous"></script>
        
      

    

    
    
    

    
    

    
    
    
      
      <script id="search-hit-fuse-template" type="text/x-template">
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script>
      
        <script src="https://cdn.jsdelivr.net/gh/krisk/Fuse@v3.2.1/dist/fuse.min.js" integrity="sha512-o38bmzBGX+hD3JHWUFCDA09btWaqrNmoJ3RXLlrysA7PP01Kgs4UlE4MhelE1v5dJR3+cxlR4qQlotsW7jKsnw==" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/gh/julmot/mark.js@8.11.1/dist/jquery.mark.min.js" integrity="sha512-mhbv5DqBMgrWL+32MmsDOt/OAvqr/cHimk6B8y/bx/xS88MVkYGPiVv2ixKVrkywF2qHplNRUvFsAHUdxZ3Krg==" crossorigin="anonymous"></script>
      
    

    
    

    
    
    
    

    
    
      
      
      
      
      
      
      
    

    

    
    
    
    <script id="page-data" type="application/json">{"use_headroom":true}</script>

    
    
      <script src="/js/wowchemy-headroom.e8fd2d733eef6a8bbbe0539398fc0547.js" type="module"></script>
    
    
    
    
    
    
    
      
      
    
    
    <script src="/en/js/wowchemy.min.a2ed145159dd33ad55ff402163350b5d.js"></script>

    
    
    
    
    
    
      
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

      <script src="/js/wowchemy-publication.b0d291ed6d27eacec233e6cf5204f99a.js" type="module"></script>






</body>
</html>
